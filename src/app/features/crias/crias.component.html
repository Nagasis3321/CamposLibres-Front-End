<div class="space-y-6">
  <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4">
    <h2 class="text-3xl font-bold text-neutral-dark">Relaciones y Crías</h2>
    <button (click)="isCriaModalOpen = true" class="btn-primary w-full sm:w-auto">
      Registrar Nueva Cría
    </button>
  </div>

  <div class="card">
    <h3 class="text-lg font-semibold text-gray-700 mb-3">Consultar Relaciones</h3>
    <div class="flex items-center space-x-2">
      <div class="flex-grow">
        <input 
          type="text" 
          [formControl]="searchControl"
          placeholder="Ingrese caravana o deje vacío para ver todo"
          class="w-full p-2 border border-gray-300 rounded-md shadow-sm">
      </div>
      <button (click)="buscarAnimal()" class="btn-primary">Consultar</button>
    </div>
  </div>

  <app-relationship-viewer 
    [animalConsultado]="animalConsultado"
    [todosLosAnimales]="todosLosAnimales"
    (editRelationshipRequest)="onEditRelationshipRequest($event)">
  </app-relationship-viewer>

  <!-- Modal para registrar nueva cría -->
  <app-modal [isOpen]="isCriaModalOpen" title="Registrar Nueva Cría" (close)="isCriaModalOpen = false">
    <app-cria-form
      [todosLosAnimales]="todosLosAnimales"
      [pelajes]="pelajes"
      (save)="onSaveCria($event)"
      (cancel)="isCriaModalOpen = false">
    </app-cria-form>
  </app-modal>

  <!-- NUEVO: Modal para editar una relación -->
  <app-modal [isOpen]="isEditRelationshipModalOpen" title="Cambiar Relación de Madre" (close)="isEditRelationshipModalOpen = false">
    <app-edit-relationship-form
      *ngIf="animalToEditRelationship"
      [animalToEdit]="animalToEditRelationship"
      [allFemaleAnimals]="allFemaleAnimals"
      (save)="onSaveRelationship($event)"
      (cancel)="isEditRelationshipModalOpen = false">
    </app-edit-relationship-form>
  </app-modal>
</div>